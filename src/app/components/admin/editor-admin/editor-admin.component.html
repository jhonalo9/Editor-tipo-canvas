<div class="app">
  <!-- Barra de herramientas -->
  <div class="toolbar">
    <!-- Herramientas de archivo -->
    <div class="file-tools">
      <input type="file" id="fileInput" (change)="loadJSON($event)" accept=".json" hidden />
      <!--<label for="fileInput" class="btn small">📂 Cargar JSON</label>-->
    </div>

   <!-- parte del toolbar -->
<div class="color-picker">
  <label for="bgColor">🎨 Fondo:</label>
  <input id="bgColor" type="color" (input)="onColorChange($event)" [value]="backgroundColor">

  <!-- Panel para línea -->
  <ng-container *ngIf="selectedType === 'line'">
    <label for="lineWidth">Grosor:</label>
    <input id="lineWidth" type="range" min="1" max="20"
           [value]="lineWidth" (input)="updateLineWidth($event)">
    <span>{{lineWidth}}px</span>
  </ng-container>

  <!-- Panel para rectángulo (usamos 'rect' aunque el nodo real sea Group) -->
  <ng-container *ngIf="selectedType === 'rect'">
    <label for="rectStrokeWidth">Borde:</label>
    <input id="rectStrokeWidth" type="range" min="0" max="20"
           [value]="rectStrokeWidth" (input)="updateRectStrokeWidth($event)">
    <span>{{rectStrokeWidth}}px</span>

    <label for="rectColor">Color:</label>
    <input id="rectColor" type="color" [value]="rectFill" (input)="updateRectFill($event)">

    <label for="rectText">Texto:</label>
    <input id="rectText" type="text" placeholder="Escribir..."
           [value]="rectText" (input)="updateRectText($event)">
  </ng-container>

  <!-- Panel para texto -->
<ng-container *ngIf="selectedType === 'text'">
  <label for="textContent">Texto:</label>
  <input id="textContent" type="text" placeholder="Escribir texto..."
         [value]="textContent" (input)="updateTextContent($event)">

  <label for="textFontSize">Tamaño:</label>
  <input id="textFontSize" type="range" min="10" max="72"
         [value]="textFontSize" (input)="updateTextFontSize($event)">
  <span>{{textFontSize}}px</span>

  <label for="textColor">Color:</label>
  <input id="textColor" type="color" [value]="textColor" (input)="updateTextColor($event)">

  <label for="textFontFamily">Fuente:</label>
  <select id="textFontFamily" [value]="textFontFamily" (change)="updateTextFontFamily($event)">
    <option value="Arial">Arial</option>
    <option value="Calibri">Calibri</option>
    <option value="Verdana">Verdana</option>
    <option value="Georgia">Georgia</option>
    <option value="Times New Roman">Times New Roman</option>
    <option value="Courier New">Courier New</option>
  </select>
</ng-container>


  <!-- 👇 PANEL PARA CÍRCULO - NUEVO -->
  <ng-container *ngIf="selectedType === 'circle'">
    <label for="circleRadius">Tamaño:</label>
    <input id="circleRadius" type="range" min="20" max="200" 
           [value]="circleRadius" (input)="updateCircleRadius($event)">
    <span>{{circleRadius}}px</span>
    
    <label for="circleStroke">Borde:</label>
    <input id="circleStroke" type="range" min="0" max="10" 
           [value]="circleStrokeWidth" (input)="updateCircleStroke($event)">
    <span>{{circleStrokeWidth}}px</span>
    
    <label for="circleStrokeColor">Color borde:</label>
    <input id="circleStrokeColor" type="color" 
           [value]="circleStrokeColor" (input)="updateCircleStrokeColor($event)">

    <!-- Botón para agregar imagen al círculo -->
    <button class="btn small" (click)="openImageGalleryForSelectedCircle()">
      🖼 Agregar Imagen
    </button>
  </ng-container>

  <!-- 👇 PANEL PARA IMAGEN SIMPLE -->
  <ng-container *ngIf="selectedType === 'image'">
    <label for="imageCornerRadius">Esquinas redondeadas:</label>
    <input id="imageCornerRadius" type="range" min="0" max="50" 
           [value]="imageCornerRadius" (input)="updateImageCornerRadius($event)">
    <span>{{imageCornerRadius}}px</span>
  </ng-container>
</div>



    <!-- Acciones -->
    <div class="actions">
      <button class="btn azul">💾 Guardar</button>
      <button class="btn primary" (click)="exportAsImage()">📤 Exportar</button>
    </div>
  </div>

  <!-- Panel lateral -->
  <div class="sidebar">
    <button class="btn primary" >Plantillas</button>
    <h3>Elementos</h3>
    <button class="btn" (click)="addRect()">🟥 Rectángulo</button>
    <button class="btn" (click)="addCircle()">⚪ Círculo</button>
    <button class="btn" (click)="addLine()">〰 Línea</button>
    <button class="btn" (click)="addCurve()">🌊 Curva</button>
    <button class="btn" (click)="addText()">🔤 Texto</button>
    <button class="btn-green" (click)="openImageGallery()">🖼 Imagen</button>
  </div>

  <!-- Área de Canvas -->
  <div class="canvas-container" id="container"></div>

  <!-- Modal de Galería de Imágenes -->
<div class="modal" [class.show]="showImageGallery">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Galería de Imágenes</h3>
      <button class="close-btn" (click)="closeImageGallery()">&times;</button>
    </div>
    
    <div class="modal-body">
      <!-- Sección para subir nueva imagen -->
      <div class="upload-section">
        <h4>Subir Nueva Imagen</h4>
        <input type="file" id="imageUpload" (change)="uploadImage($event)" accept="image/*" hidden>
        <label for="imageUpload" class="btn primary">📁 Seleccionar Imagen</label>
      </div>

    

      <!-- Galería de imágenes -->
      <div class="gallery-section">
        <h4>Imágenes Disponibles</h4>
        <div class="image-grid">
          <div *ngFor="let image of userImages; let i = index" 
               class="image-item" 
               [class.selected]="selectedGalleryImage?.url === image.url"
               (click)="selectImage(image)">
            <img [src]="image.url" [alt]="image.name">
            <div class="image-info">
              <span>{{image.name}}</span>
              <button class="btn small delete-btn" (click)="$event.stopPropagation(); deleteImage(i)">🗑️</button>
            </div>
          </div>
          
          <div *ngIf="userImages.length === 0" class="empty-gallery">
            <p>No hay imágenes en la galería. Sube una imagen para comenzar.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn" (click)="closeImageGallery()">Cancelar</button>
      <button class="btn primary" (click)="addImageCircleToCanvas()" 
              [disabled]="!selectedGalleryImage">
        Agregar Círculo con Imagen
      </button>
      <button class="btn secondary" (click)="addSimpleImageToCanvas()" 
              [disabled]="!selectedGalleryImage">
        Agregar Imagen Simple
      </button>
    </div>
  </div>
</div>







 
</div>
