<div class="admin-container">
  
  <h2>Administrador de Plantillas</h2>
  
  <div *ngIf="!isLoggedIn" class="alert alert-warning">
    <p>Por favor, inicie sesi칩n para administrar plantillas.</p>
  </div>

  <div *ngIf="isLoggedIn">
    <!-- Formulario de plantilla -->
    <div class="form-section">
      <h3>{{ plantillaSeleccionada ? 'Editar Plantilla' : 'Crear Nueva Plantilla' }}</h3>
      
      <form [formGroup]="plantillaForm">
        <div class="form-group">
          <label for="nombre">Nombre:</label>
          <input id="nombre" type="text" formControlName="nombre" class="form-control" 
                 placeholder="Ingrese el nombre de la plantilla">
          <div *ngIf="plantillaForm.get('nombre')?.invalid && plantillaForm.get('nombre')?.touched" 
               class="error-message">
            El nombre es requerido
          </div>
        </div>
        
        <div class="form-group">
          <label for="descripcion">Descripci칩n:</label>
          <textarea id="descripcion" formControlName="descripcion" class="form-control"
                    placeholder="Descripci칩n opcional de la plantilla"></textarea>
        </div>
        
        <div class="button-group">
          <button *ngIf="!plantillaSeleccionada" type="button" 
                  (click)="crearPlantilla()" 
                  [disabled]="plantillaForm.invalid" class="btn btn-primary">
            Crear Plantilla
          </button>
          
          <button *ngIf="plantillaSeleccionada" type="button" 
                  (click)="actualizarPlantilla()" 
                  [disabled]="plantillaForm.invalid" class="btn btn-success">
            Actualizar Plantilla
          </button>
          
          <button *ngIf="plantillaSeleccionada" type="button" 
                  (click)="cancelarEdicion()" 
                  class="btn btn-secondary">
            Cancelar
          </button>

          <button type="button" (click)="nuevaPlantilla()" class="btn btn-info">
            Nueva Plantilla
          </button>
        </div>
      </form>
      
      <div *ngIf="mensaje" class="alert alert-info mt-3">{{ mensaje }}</div>
    </div>

    <!-- Editor -->
    <div class="editor-section">
      <h3>Editor de Plantillas</h3>
      <p class="editor-instructions">Use las herramientas abajo para crear su dise침o, luego guarde la plantilla.</p>
      <app-editor-admin #editor></app-editor-admin>
    </div>

    <!-- Lista de plantillas existentes -->
    <div class="plantillas-section">
      <h3>Plantillas Existentes</h3>
      
      <div *ngIf="plantillas.length === 0" class="alert alert-info">
        No hay plantillas disponibles. Cree una nueva plantilla usando el editor.
      </div>
      
      <div *ngIf="plantillas.length > 0" class="plantillas-list">
        <div *ngFor="let plantilla of plantillas" class="plantilla-item"
             [class.selected]="plantillaSeleccionada?.id === plantilla.id">
          <h4>{{ plantilla.nombre }}</h4>
          <p *ngIf="plantilla.descripcion">{{ plantilla.descripcion }}</p>
          
          <div class="plantilla-actions">
            <button (click)="seleccionarPlantilla(plantilla)" class="btn btn-sm btn-outline-primary">
              {{ plantillaSeleccionada?.id === plantilla.id ? 'Editando...' : 'Editar' }}
            </button>
            <button (click)="eliminarPlantilla(plantilla)" class="btn btn-sm btn-outline-danger">
              Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>