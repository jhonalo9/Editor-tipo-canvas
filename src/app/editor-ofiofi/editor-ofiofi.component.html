<!-- components/admin-event-design/admin-event-design.component.html -->
<div class="admin-container">
  <div class="admin-header">
    <h1>游꿛 Administrador de Dise침os de Eventos</h1>
    <p>Crea y gestiona dise침os personalizados para los eventos de la l칤nea de tiempo</p>
  </div>

  <!-- Lista de dise침os existentes -->
  <div class="designs-list" *ngIf="!isEditing">
    <div class="section-header">
      <h2>Dise침os Existentes</h2>
      <button class="btn btn-primary" (click)="createNewDesign()">
        <i class="fa-solid fa-plus"></i> Nuevo Dise침o
      </button>
    </div>

    <div class="designs-grid">
      <div *ngFor="let design of designs" class="design-card">
        <div class="design-preview">
          <div class="preview-placeholder">
            <div class="preview-elements">
              <div class="preview-connector"></div>
              <div class="preview-image-container" 
                   [class.circle]="hasCircleImageContainer(design)"
                   [class.square]="hasSquareImageContainer(design)"
                   [class.rectangle]="hasRectangleImageContainer(design)"
                   *ngIf="countElementsByType(design, 'image-container') > 0">
              </div>
              <div class="preview-title-box"></div>
            </div>
          </div>
        </div>
        
        <div class="design-info">
          <h3>{{ design.name }}</h3>
          <p>{{ design.description }}</p>
          <div class="design-meta">
            <span class="category">{{ design.category === 'con-imagen' ? '游닝 Con Imagen' : '游닇 Sin Imagen' }}</span>
            <span class="elements">{{ design.elements.length }} elementos</span>
          </div>
        </div>

        <div class="design-actions">
          <button class="btn btn-sm btn-outline" (click)="editDesign(design)">
            <i class="fa-solid fa-edit"></i> Editar
          </button>
          <button class="btn btn-sm btn-outline" (click)="duplicateDesign(design)">
            <i class="fa-solid fa-copy"></i> Duplicar
          </button>
          <button class="btn btn-sm btn-danger" (click)="deleteDesign(design)">
            <i class="fa-solid fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="designs.length === 0" class="empty-state">
      <i class="fa-solid fa-palette"></i>
      <h3>No hay dise침os creados</h3>
      <p>Crea tu primer dise침o personalizado para eventos</p>
      <button class="btn btn-primary" (click)="createNewDesign()">
        Crear Primer Dise침o
      </button>
    </div>
  </div>

  <!-- Editor de dise침o -->
  <div *ngIf="isEditing && selectedDesign" class="design-editor">
    <div class="editor-header">
      <h2>{{ selectedDesign.id.startsWith('design-') ? 'Creando' : 'Editando' }} Dise침o: {{ selectedDesign.name }}</h2>
      <div class="editor-actions">
        <button class="btn btn-secondary" (click)="previewDesign()">
          <i class="fa-solid fa-eye"></i> Previsualizar
        </button>
        <button class="btn btn-secondary" (click)="cancelEdit()">
          <i class="fa-solid fa-times"></i> Cancelar
        </button>
        <button class="btn btn-primary" (click)="saveDesign()">
          <i class="fa-solid fa-save"></i> Guardar Dise침o
        </button>
      </div>
    </div>

    <div class="editor-content">
      <!-- Configuraci칩n general -->
      <div class="editor-section">
        <h3>游늶 Configuraci칩n General</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>Nombre del Dise침o:</label>
            <input type="text" [(ngModel)]="selectedDesign.name" class="form-input" placeholder="Ej: C칤rculo Moderno">
          </div>
          
          <div class="form-group">
            <label>Descripci칩n:</label>
            <textarea [(ngModel)]="selectedDesign.description" class="form-textarea" 
                     placeholder="Describe el dise침o..."></textarea>
          </div>
          
          <div class="form-group">
            <label>Categor칤a:</label>
            <select [(ngModel)]="selectedDesign.category" class="form-select">
              <option value="con-imagen">Con Imagen</option>
              <option value="sin-imagen">Sin Imagen</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Estilos generales -->
      <div class="editor-section">
        <h3>游꿛 Estilos Generales</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>Color de Fondo:</label>
            <input type="color" [(ngModel)]="selectedDesign.styles.backgroundColor" class="form-color">
          </div>
          
          <div class="form-group">
            <label>Espaciado entre eventos:</label>
            <input type="number" [(ngModel)]="selectedDesign.styles.spacing" class="form-input" min="80" max="200">
          </div>
          
          <div class="form-group">
            <label>Estilo del Conector:</label>
            <select [(ngModel)]="selectedDesign.styles.connectorStyle" class="form-select">
              <option *ngFor="let style of connectorStyles" [value]="style.value">
                {{ style.label }}
              </option>
            </select>
          </div>
          
          <div class="form-group">
            <label>Intensidad de Sombra:</label>
            <input type="range" [(ngModel)]="selectedDesign.styles.shadowIntensity" 
                   class="form-range" min="0" max="10">
            <span>{{ selectedDesign.styles.shadowIntensity }}</span>
          </div>
        </div>
      </div>

      <!-- Gesti칩n de elementos -->
      <div class="editor-section">
        <div class="section-header">
          <h3>游빌 Elementos del Dise침o</h3>
          <div class="element-buttons">
            <button *ngFor="let type of elementTypes" 
                    class="btn btn-sm btn-outline"
                    (click)="addElement($any(type.value))">
              + {{ type.label }}
            </button>
          </div>
        </div>

        <div *ngIf="selectedDesign.elements.length === 0" class="empty-elements">
          <p>No hay elementos en este dise침o. Agrega algunos elementos para comenzar.</p>
        </div>

        <div *ngFor="let element of selectedDesign.elements; let i = index" class="element-item">
          <div class="element-header">
            <h4>{{ getElementTypeLabel(element.type) }}</h4>
            <div class="element-actions">
              <button class="btn btn-sm" (click)="moveElementUp(i)" [disabled]="i === 0">
                <i class="fa-solid fa-arrow-up"></i>
              </button>
              <button class="btn btn-sm" (click)="moveElementDown(i)" 
                      [disabled]="i === selectedDesign.elements.length - 1">
                <i class="fa-solid fa-arrow-down"></i>
              </button>
              <button class="btn btn-sm btn-danger" (click)="removeElement(i)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </div>
          </div>

          <div class="element-config">
            <!-- Posici칩n -->
            <div class="form-group">
              <label>Posici칩n (X, Y):</label>
              <div class="position-inputs">
                <input type="number" [(ngModel)]="element.position.x" class="form-input-sm" placeholder="X">
                <input type="number" [(ngModel)]="element.position.y" class="form-input-sm" placeholder="Y">
              </div>
            </div>

            <!-- Tama침o (si aplica) -->
            <div *ngIf="element.size" class="form-group">
              <label>Tama침o:</label>
              <div class="size-config">
                <select [(ngModel)]="element.size.type" 
                        (change)="changeSizeType(element, $any($event.target).value)"
                        class="form-select-sm">
                  <option value="circle">C칤rculo</option>
                  <option value="rectangle">Rect치ngulo</option>
                  <option value="square">Cuadrado</option>
                </select>

                <div *ngIf="element.size.type === 'circle'" class="size-inputs">
                  <input type="number" [(ngModel)]="element.size.radius" class="form-input-sm" placeholder="Radio">
                </div>

                <div *ngIf="element.size.type === 'rectangle'" class="size-inputs">
                  <input type="number" [(ngModel)]="element.size.width" class="form-input-sm" placeholder="Ancho">
                  <input type="number" [(ngModel)]="element.size.height" class="form-input-sm" placeholder="Alto">
                  <input type="number" [(ngModel)]="element.size.cornerRadius" class="form-input-sm" placeholder="Radio esquina">
                </div>

                <div *ngIf="element.size.type === 'square'" class="size-inputs">
                  <input type="number" [(ngModel)]="element.size.size" class="form-input-sm" placeholder="Tama침o">
                  <input type="number" [(ngModel)]="element.size.cornerRadius" class="form-input-sm" placeholder="Radio esquina">
                </div>
              </div>
            </div>

            <!-- Contenido (si aplica) -->
            <div *ngIf="element.content" class="form-group">
              <label>Contenido:</label>
              <select [(ngModel)]="element.content.field" class="form-select-sm">
                <option value="title">T칤tulo</option>
                <option value="year">A침o</option>
                <option value="description">Descripci칩n</option>
                <option value="image">Imagen</option>
              </select>
              <input *ngIf="element.content.maxLength !== undefined" 
                     type="number" [(ngModel)]="element.content.maxLength" 
                     class="form-input-sm" placeholder="M치x. caracteres">
            </div>

            <!-- Estilos -->
            <div class="form-group">
              <label>Color de relleno:</label>
              <input type="color" [(ngModel)]="element.styles.fill" class="form-color-sm">
            </div>

            <div class="form-group">
              <label>Color de borde:</label>
              <input type="color" [(ngModel)]="element.styles.stroke" class="form-color-sm">
            </div>

            <div *ngIf="element.styles.strokeWidth !== undefined" class="form-group">
              <label>Ancho de borde:</label>
              <input type="number" [(ngModel)]="element.styles.strokeWidth" class="form-input-sm">
            </div>

            <div *ngIf="element.styles.fontSize !== undefined" class="form-group">
              <label>Tama침o de fuente:</label>
              <input type="number" [(ngModel)]="element.styles.fontSize" class="form-input-sm">
            </div>

            <div *ngIf="element.styles.fontFamily !== undefined" class="form-group">
              <label>Fuente:</label>
              <select [(ngModel)]="element.styles.fontFamily" class="form-select-sm">
                <option *ngFor="let font of fontFamilies" [value]="font.value">
                  {{ font.label }}
                </option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>