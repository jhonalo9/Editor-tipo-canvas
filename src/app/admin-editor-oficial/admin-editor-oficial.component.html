<!-- admin-template-designer.component.html -->
<div class="template-designer">
  <div class="designer-header">
    <h2>🎨 Diseñador de Plantillas</h2>
    <p>Crea plantillas de diseño que los usuarios puedan aplicar a sus líneas de tiempo</p>
    <button class="btn btn-primary" (click)="createTemplate()">
      🎨 Nueva Plantilla de Diseño
    </button>
  </div>

  <div class="templates-grid">
    <div *ngFor="let template of templates; trackBy: trackByTemplateId" class="template-card">
      <div class="template-preview" [style.background]="template.styles.backgroundColor">
        <div class="preview-timeline" [style.background]="template.styles.timelineColor"></div>
        <div class="preview-events">
          <div class="preview-event" [style.background]="template.styles.eventColor"></div>
          <div class="preview-event" [style.background]="template.styles.eventColor"></div>
          <div class="preview-event" [style.background]="template.styles.eventColor"></div>
        </div>
      </div>
      
      <div class="template-info">
        <h3 [style.color]="template.styles.textColor">{{template.name}}</h3>
        <p>{{template.description}}</p>
        <div class="template-meta">
          <span>{{template.category}}</span>
          <span>{{template.isPublic ? '🌐 Pública' : '🔒 Privada'}}</span>
        </div>
        
        <div class="template-actions">
          <button class="btn btn-sm btn-primary" (click)="editTemplate(template)">
            ✏️ Editar Diseño
          </button>
          <button class="btn btn-sm btn-danger" (click)="deleteTemplate(template)">
            🗑️ Eliminar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de diseño -->
  <div *ngIf="showTemplateModal" class="modal-overlay" (click)="closeTemplateModal()">
    <div class="modal-content design-modal" (click)="$event.stopPropagation()">
      <h3>{{editingTemplate ? '✏️ Editar' : '🎨 Crear'}} Plantilla de Diseño</h3>
      
      <div class="design-container">
        <!-- Panel de configuración -->
        <div class="config-panel">
          <div class="form-section">
            <h4>📝 Información Básica</h4>
            
            <div class="form-group">
              <label>Nombre de la plantilla:</label>
              <input type="text" [(ngModel)]="newTemplate.name" 
                     (input)="onStyleChange()"
                     placeholder="Ej: Moderno Minimalista">
            </div>

            <div class="form-group">
              <label>Descripción:</label>
              <textarea [(ngModel)]="newTemplate.description" 
                        placeholder="Describe el estilo de diseño..."></textarea>
            </div>

            <div class="form-group">
              <label>Categoría:</label>
              <input type="text" [(ngModel)]="newTemplate.category" 
                     placeholder="Ej: Profesional, Moderno, Clásico">
            </div>
          </div>

          <div class="form-section">
            <h4>🎨 Colores</h4>
            
            <div class="color-grid">
              <div class="color-input">
                <label>Fondo:</label>
                <input type="color" [(ngModel)]="newTemplate.styles.backgroundColor" 
                       (change)="onStyleChange()">
              </div>
              <div class="color-input">
                <label>Línea de tiempo:</label>
                <input type="color" [(ngModel)]="newTemplate.styles.timelineColor" 
                       (change)="onStyleChange()">
              </div>
              <div class="color-input">
                <label>Eventos:</label>
                <input type="color" [(ngModel)]="newTemplate.styles.eventColor" 
                       (change)="onStyleChange()">
              </div>
              <div class="color-input">
                <label>Texto:</label>
                <input type="color" [(ngModel)]="newTemplate.styles.textColor" 
                       (change)="onStyleChange()">
              </div>
            </div>
          </div>

          <div class="form-section">
            <h4>🔤 Tipografía</h4>
            
            <div class="form-group">
              <label>Fuente:</label>
              <select [(ngModel)]="newTemplate.styles.fontFamily" 
                      (change)="onStyleChange()">
                <option *ngFor="let font of fontFamilies" [value]="font">
                  {{font.split(',')[0]}}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label>Tamaño título:</label>
              <input type="range" min="10" max="20" 
                     [(ngModel)]="newTemplate.styles.titleFontSize"
                     (input)="onStyleChange()">
              <span>{{newTemplate.styles.titleFontSize}}px</span>
            </div>
          </div>

          <div class="form-section">
            <h4>📐 Diseño</h4>
            
            <div class="form-group">
              <label>Posición línea:</label>
              <select [(ngModel)]="newTemplate.layout.timelinePosition">
                <option *ngFor="let pos of timelinePositions" [value]="pos">
                  {{pos === 'top' ? 'Superior' : pos === 'center' ? 'Centro' : 'Inferior'}}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label>Orientación eventos:</label>
              <select [(ngModel)]="newTemplate.layout.eventOrientation">
                <option *ngFor="let orient of eventOrientations" [value]="orient">
                  {{orient === 'alternate' ? 'Alternada' : orient === 'above' ? 'Arriba' : 'Abajo'}}
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Preview en tiempo real -->
        <div class="preview-panel">
          <h4>👁️ Vista Previa</h4>
          <div class="live-preview" [ngStyle]="previewStyles">
            <div class="preview-timeline-full" 
                 [style.background]="newTemplate.styles.timelineColor"></div>
            <div class="preview-events-full">
              <div class="preview-event-full" 
                   [style.background]="newTemplate.styles.eventColor">
                <span class="event-year">2020</span>
                <span class="event-title">Evento de ejemplo</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn btn-secondary" (click)="closeTemplateModal()">
          ❌ Cancelar
        </button>
        <button class="btn btn-primary" (click)="saveTemplate()"
                [disabled]="!newTemplate.name.trim()">
          💾 {{editingTemplate ? 'Actualizar' : 'Crear'}} Diseño
        </button>
      </div>
    </div>
  </div>
</div>